---
phase: 07-neighbors-removal
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/main/java/world/bentobox/islandselector/commands/NeighborsCommand.java
  - src/main/java/world/bentobox/islandselector/gui/NeighborhoodGUI.java
  - src/main/java/world/bentobox/islandselector/commands/IslandSelectorCommand.java
  - src/main/java/world/bentobox/islandselector/gui/MainGridGUI.java
  - src/main/java/world/bentobox/islandselector/gui/SharedGridGUIListener.java
  - src/main/resources/addon.yml
  - src/main/resources/locales/en-US.yml
  - src/main/resources/config.yml
autonomous: true

must_haves:
  truths:
    - "Main GUI does not show a neighbors button at slot 49"
    - "Running /islandselector neighbors returns unknown command error"
    - "No neighbors-related permissions exist in addon.yml"
    - "Project compiles successfully with mvn clean compile"
  artifacts:
    - path: "src/main/java/world/bentobox/islandselector/commands/NeighborsCommand.java"
      provides: "DELETED - file must not exist"
    - path: "src/main/java/world/bentobox/islandselector/gui/NeighborhoodGUI.java"
      provides: "DELETED - file must not exist"
    - path: "src/main/java/world/bentobox/islandselector/commands/IslandSelectorCommand.java"
      provides: "No NeighborsCommand registration"
      pattern_absent: "NeighborsCommand"
    - path: "src/main/java/world/bentobox/islandselector/gui/MainGridGUI.java"
      provides: "No neighborhood button or slot constant"
      pattern_absent: "NEIGHBORHOOD"
    - path: "src/main/java/world/bentobox/islandselector/gui/SharedGridGUIListener.java"
      provides: "No NeighborhoodGUI import or click handler"
      pattern_absent: "NeighborhoodGUI|getNeighborhoodSlot"
    - path: "src/main/resources/addon.yml"
      provides: "No neighbors permission"
      pattern_absent: "islandselector.neighbors"
  key_links:
    - from: "IslandSelectorCommand.java"
      to: "NeighborsCommand.java"
      via: "subcommand registration"
      status: "BROKEN (intentional - file deleted)"
    - from: "SharedGridGUIListener.java"
      to: "NeighborhoodGUI.java"
      via: "click handler instantiation"
      status: "BROKEN (intentional - file deleted)"
---

<objective>
Remove the neighbors/neighborhood feature completely from IslandSelector addon.

Purpose: Simplify the addon by removing unused feature (v1.1 simplification milestone)
Output: Clean codebase with no neighbors feature references, successful compilation
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-neighbors-removal/07-RESEARCH.md
@CLAUDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete source files and remove code references</name>
  <files>
    src/main/java/world/bentobox/islandselector/commands/NeighborsCommand.java (DELETE)
    src/main/java/world/bentobox/islandselector/gui/NeighborhoodGUI.java (DELETE)
    src/main/java/world/bentobox/islandselector/commands/IslandSelectorCommand.java
    src/main/java/world/bentobox/islandselector/gui/MainGridGUI.java
    src/main/java/world/bentobox/islandselector/gui/SharedGridGUIListener.java
  </files>
  <action>
    1. DELETE NeighborsCommand.java entirely
    2. DELETE NeighborhoodGUI.java entirely
    3. Edit IslandSelectorCommand.java:
       - Remove line 37: `new NeighborsCommand(this);`
    4. Edit MainGridGUI.java:
       - Remove constant: `private static final int BOT_NEIGHBORHOOD_SLOT = 49;` (line 67)
       - Remove button creation in populateControlButtons() (lines 717-720):
         ```java
         // Neighborhood View
         ItemStack neighborhood = createButton(Material.FILLED_MAP, "&bNeighborhood",
             "&7View your neighbors");
         inventory.setItem(BOT_NEIGHBORHOOD_SLOT, neighborhood);
         ```
       - Remove getter method (lines 980-982):
         ```java
         public int getNeighborhoodSlot() {
             return BOT_NEIGHBORHOOD_SLOT;
         }
         ```
    5. Edit SharedGridGUIListener.java:
       - Remove import: `import world.bentobox.islandselector.gui.NeighborhoodGUI;`
       - Remove click handler block (lines 79-82):
         ```java
         if (slot == gui.getNeighborhoodSlot()) {
             player.closeInventory();
             new NeighborhoodGUI(gui.getAddon(), player).open();
             return;
         }
         ```

    NOTE: The `neighbors_online` placeholder in PlaceholderAPIIntegration.java is KEPT
    intentionally - it calculates online players in adjacent grid cells independently
    of the GUI and remains useful for scoreboards/tab lists.
  </action>
  <verify>
    Run: `mvn clean compile -q`
    Expected: BUILD SUCCESS with no compilation errors

    Run: `grep -ri "NeighborhoodGUI\|NeighborsCommand\|getNeighborhoodSlot\|BOT_NEIGHBORHOOD" src/main/java/`
    Expected: No matches (empty output)
  </verify>
  <done>
    - NeighborsCommand.java deleted
    - NeighborhoodGUI.java deleted
    - All Java references removed
    - Project compiles successfully
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean up resource files</name>
  <files>
    src/main/resources/addon.yml
    src/main/resources/locales/en-US.yml
    src/main/resources/config.yml
  </files>
  <action>
    1. Edit addon.yml:
       - Remove permission block (lines 43-45):
         ```yaml
         islandselector.neighbors:
           description: Can use neighborhood view
           default: true
         ```

    2. Edit en-US.yml:
       - Remove neighborhood control button locale (lines 64-65):
         ```yaml
         neighborhood: "&aNeighborhood View"
         neighborhood-desc: "&7View your neighbors"
         ```
       - Remove entire neighborhood GUI section (lines 100-106):
         ```yaml
         # Neighborhood GUI
         neighborhood:
           title: "Your Neighborhood"
           your-island: "&a&l YOUR ISLAND"
           back: "&aBack to Grid"
           slots: "&eSlot Selection"
           close: "&cClose"
         ```

    3. Edit config.yml:
       - Remove from gui.buttons section (line 122):
         ```yaml
         neighborhood: FILLED_MAP
         ```
  </action>
  <verify>
    Run: `grep -ri "neighbor" src/main/resources/`
    Expected: Only matches for "neighbors" in confirmation GUI context (claim-neighbors) - NOT neighborhood feature

    Run: `grep "islandselector.neighbors" src/main/resources/addon.yml`
    Expected: No matches (empty output)
  </verify>
  <done>
    - Permission `islandselector.neighbors` removed from addon.yml
    - Neighborhood locale keys removed from en-US.yml
    - Neighborhood button config removed from config.yml
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. Compilation check:
   ```bash
   mvn clean package -q
   ```
   Expected: BUILD SUCCESS, JAR created in target/

2. No remaining references check:
   ```bash
   grep -ri "neighborhood\|NeighborhoodGUI\|NeighborsCommand" src/ --include="*.java" --include="*.yml"
   ```
   Expected: Only `claim-neighbors` in locale (unrelated - shows neighbor count during claim)

3. Files deleted check:
   ```bash
   ls src/main/java/world/bentobox/islandselector/commands/NeighborsCommand.java 2>&1
   ls src/main/java/world/bentobox/islandselector/gui/NeighborhoodGUI.java 2>&1
   ```
   Expected: "No such file or directory" for both
</verification>

<success_criteria>
- [REM-01] Main GUI slot 49 will be auto-filled by `fillEmptySlots()` - no neighbors button
- [REM-02] `/islandselector neighbors` returns unknown command (subcommand not registered)
- [REM-03] NeighborhoodGUI.java and NeighborsCommand.java deleted
- [REM-04] `islandselector.neighbors` permission removed from addon.yml
- [REM-05] Neighborhood locale keys removed from en-US.yml
- Project compiles and builds successfully
</success_criteria>

<output>
After completion, create `.planning/phases/07-neighbors-removal/07-01-SUMMARY.md`
</output>
